"use strict";!function(t){function e(){t(document).on("click",".search-form-ico-mobile",function(){t("#serch-form").addClass("full-width")}),t("#serch-form").click(function(){t(this).addClass("full-width")}),t(document).on("click",".search-form-close",function(){t("#serch-form").removeClass("full-width")}),t(document).on("click",".mobi-par-cart__door-open",function(){var e=t(this).parents(".mobi-par-cart"),i=e.attr("data-blick");t(this).css("display","none"),e.find(".mobi-par-cart__door-close").css("display","inline-block"),e.find(".mobi-par-cart__info").slideDown(),BX.arh_obj_block_open[i]=!0}),t(document).on("click",".mobi-par-cart__door-close",function(){var e=t(this).parents(".mobi-par-cart"),i=e.attr("data-blick");t(this).css("display","none"),e.find(".mobi-par-cart__door-open").css("display","inline-block"),e.find(".mobi-par-cart__info").slideUp(),BX.arh_obj_block_open[i]=!1})}function i(){var e=t(".adress");0<e.length&&(t(document).on("click",".adress",function(){t(this).toggleClass("is-open"),t(".adress__list").slideToggle(300,"linear")}),e.hover(function(){},function(){t(this).removeClass("is-open"),t(".adress__list").slideUp(300,"linear")}))}function o(){var e=t(".sort-view__link");if(0<e.length){var i={0:"",1:"catalog-goriz",2:"catalog-tabl"},o="is-select",n=localStorage.getItem("vid_catalog_index");null!==n&&(t("body").addClass(i[n]),e.removeClass(o),t(e[n]).addClass(o)),t(document).on("click",".sort-view__link",function(){var n=t(this),s=n.index();e.removeClass(o),n.addClass(o),t.each(i,function(e,i){t("body").removeClass(i)}),t("body").addClass(i[s]),localStorage.setItem("vid_catalog_index",s)})}}function n(){0<t(".catalog-category").length&&t(document).on("click",".catalog-category__sub",function(){var e=t(this).parents(".catalog-category__item");e.toggleClass("is-open"),e.find(".deep-lev-1").slideToggle()}),t(document).on("click",".mobile-button",function(){t(this).parent(".catalog-category").toggleClass("opened")})}function s(){var e=t("#filter-form-catalog");if(0<e.length){var i=!0;t(document).on("change",".filter-block__checkbox-input",function(){var o=t(this).parents(".filter-block__container"),n=0,s=[];t.each(o.find(".filter-block__checkbox-input"),function(){t(this).prop("checked")&&n++}),t.each(e.find(".filter-block__checkbox-input"),function(){t(this).prop("checked")&&s.push(t(this).next(".filter-block__checkbox-fufel").find(".filter-block__checkbox-name").text())}),n=0<n?"("+n+")":"",o.find(".filter-block__count").text(n);var r=e.attr("action")+"?";r+=e.serialize()+"&set_filter=1",i&&t.get(r,function(e){var i=t(e);t(".js-load-prod").empty().append(i.find(".catalog-product__item")),t(".js-load-paging").empty().append(i.find(".js-load-paging .paging-block"));var o="<span class='fil-res'>Найдено ",n=1*i.find(".filter-block").attr("data-count");o+=n+" "+a(n,"товар","товара","товаров")+" по фильтрам:<span>",o+=" "+s.join(", "),o=0<s.length?o:"",t(".filter-itog__text").html(o)})}),t(document).on("click",".js-load-paging a",function(){var e=t(this).attr("href");return t.get(e,function(e){var i=t(e);t(".js-load-prod").empty().append(i.find(".catalog-product__item")),t(".js-load-paging").empty().append(i.find(".js-load-paging .paging-block"))}),!1}),t(document).on("click",".js-filter-res",function(){i=!1,t.each(e.find(".filter-block__checkbox-input"),function(){t(this).prop("checked")&&t(this).trigger("click")}),i=!0;var o=e.attr("action")+"?del_filter=1";t.get(o,function(e){var i=t(e);t(".js-load-prod").empty().append(i.find(".catalog-product__item")),t(".js-load-paging").empty().append(i.find(".js-load-paging .paging-block")),t(".filter-itog__text").empty()})})}}function a(t,e,i,o){var t=v(t)%100,n=t%10;return 10<t&&20>t?o:1<n&&5>n?i:1==n?e:o}function r(){t(document).on("input",".js-card-count",function(){var e=t(this),i=e.parents(".js-prod-item"),o=1*e.val();0>=o&&(o=1,e.val(o));var n=i.find(".js-add-basket").attr("data-link");n=t.parseJSON(n).price,n=parseFloat(n)*o,n=g(n,0," "," ")+" Р",i.find(".js-cart-price").text(n)}),t(document).on("click",".js-sel-product",function(){var e=t(this),i=e.parents(".js-prod-item"),o=e.attr("data-big-data");i.find(".js-sel-product").removeClass("is-chek"),e.addClass("is-chek");var n=t.parseJSON(o).price;n=parseFloat(n)*(1*i.find(".js-card-count").val()),n=g(n,0," "," ")+" Р",i.find(".js-cart-price").text(n),i.find(".js-add-basket").attr("data-link",o)}),t(document).on("click",".js-offers-toggle",function(){var e=t(this).parents(".js-prod-item");e.find(".js-offers-hid").slideToggle(),e.find(".js-variation").toggleClass("is-show")}),t(document).on("click",".js-add-basket",function(){var e=t(this).parents(".js-prod-item"),i=t(this).attr("data-link");i=t.parseJSON(i).basket_link,i+="&quantity="+e.find(".js-card-count").val(),window.location.href=i}),t(document).on("click",".js-card-plus, .js-card-minus",function(){var e=t(this).parents(".js-cart-counter"),i=e.find(".js-card-count").val();t(this).hasClass("js-card-plus")?i++:t(this).hasClass("js-card-minus")&&(i--,i=0>=i?1:i);var o=t.parseJSON(e.find(".js-add-basket").attr("data-link"));o=parseFloat(o.price)*i,o=g(o,0," "," ")+" Р",e.find(".js-cart-price").text(o),e.find(".js-card-count").val(i)}),t(document).on("change",".js-card-count",function(){0>=t(this).val()&&t(this).val("1")})}function l(){t(document).on("click",".js-modal-coupon",function(){return t(".market-cart").addClass("coupon-show"),!1}),t(document).on("click",".coupon-modal__close",function(){t(".market-cart").removeClass("coupon-show")})}function c(){t(".arh-sel-city").selectPlug({class:"order-city-sel",changeSelect:{"#select-region-origin":{value:""},"#recent-delivery-value":{value:""},"#select-region-order":{value:""}}})}function d(){t(".product-slider").slick({slidesToShow:1,slidesToScroll:1,infinite:!0,arrows:!0,fade:!0,asNavFor:".product-slider-mini",prevArrow:'<button type="button" class="slick-prev"></button>',nextArrow:'<button type="button" class="slick-next"></button>'}),t(".product-slider-mini").slick({slidesToShow:4,slidesToScroll:1,infinite:!0,focusOnSelect:!0,asNavFor:".product-slider",dots:!1,arrows:!1})}function p(){t(".prod-light-box").fancybox()}function u(){t(document).on("click",".nav-burger",function(){t(this).toggleClass("open"),t(".header-mobile-menu").toggleClass("open")})}function h(){function e(e){var i=t("#order-country").val(),o=window.order_city[i],n="",s=0;1<e.length&&(n+='<div class="gorod-text__list">',t.each(o,function(t,i){var o=i.toLowerCase(),a=e.toLowerCase();-1<o.indexOf(a)&&(n+='<span class="gorod-text__item" data-code="'+t+'">'+i+"</span>",s++)}),n+="<div>"),t(".gorod-text__list").remove(),t("#select-region-origin, #recent-delivery-value").val(""),0<s&&t(".gorod-text").append(n)}t(document).on("input","#select-region-order",function(){t(this).removeClass("error"),e(t(this).val())}),t(document).on("click",".gorod-text__item",function(){t("#select-region-order").val(t(this).text()).removeClass("error"),t("#select-region-origin, #recent-delivery-value").val(t(this).attr("data-code")),t(".gorod-text__list").remove(),BX.Sale.OrderAjaxComponent.sendRequest()}),t(document).on("input","#select-region-order",function(){""==t(this).val()&&BX.Sale.OrderAjaxComponent.sendRequest()})}function f(){t(document).on("change",".order-row__payment-input",function(){t(".order-row__payment-desc").slideUp(),t(this).parents(".order-row__payment-row").find(".order-row__payment-desc").slideDown(),t(".order-row__payment-row").removeClass("error"),BX.Sale.OrderAjaxComponent.sendRequest()}),t(document).on("change",".order-row__delivery-input",function(){t(".order-row__delivery-desc").slideUp(),t(this).parents(".order-row__delivery-row").find(".order-row__delivery-desc").slideDown(),t(".order-row__delivery-row").removeClass("error"),BX.Sale.OrderAjaxComponent.sendRequest()}),t(document).on("change","#kolhoz-text-chek-input",function(){t(this).prop("checked")?(t(".order-buyer-gorod, .order-buyer-dom").removeAttr("style"),t("#select-region-origin, #select-region-order, #recent-delivery-value").val(""),t("#select-region-order").css({opacity:.3,"pointer-events":"none"}).removeClass("error"),t("#alt-local").val(1)):(t(".order-buyer-gorod, .order-buyer-dom").css("display","none"),t("#select-region-order").removeAttr("style"),t("#alt-local").val(0))}),t(document).on("click",".save-order-arh",function(){var e=!0,i=null,o="";return""!=t("#select-region-origin").val()||t("#kolhoz-text-chek-input").prop("checked")||(o="#select-region-order",i="#err-city",e=!1),e&&t.each(t(".order-row__delivery-input"),function(){return t(this).prop("checked")?(e=!0,!1):(o=".order-row__delivery-row",i="#err-del",void(e=!1))}),e&&t.each(t(".order-row__payment-input"),function(){return t(this).prop("checked")?(e=!0,!1):(o=".order-row__payment-row",i="#err-pay",void(e=!1))}),e&&(o=[],""==t(".order-buyer-name input").val()&&(o.push(".order-buyer-name .order-buyer__field"),e=!1),""==t(".order-buyer-famil input").val()&&(o.push(".order-buyer-famil .order-buyer__field"),e=!1),""==t(".order-buyer-phone input").val()&&(o.push(".order-buyer-phone .order-buyer__field"),e=!1),""==t(".order-buyer-index input").val()&&(o.push(".order-buyer-index .order-buyer__field"),e=!1),(""==t(".order-buyer-email input").val()||-1==t(".order-buyer-email input").val().indexOf("@"))&&(o.push(".order-buyer-email .order-buyer__field"),e=!1),t("#kolhoz-text-chek-input").prop("checked")&&(""==t(".order-buyer-gorod input").val()&&(o.push(".order-buyer-gorod .order-buyer__field"),e=!1),""==t(".order-buyer-dom input").val()&&(o.push(".order-buyer-dom .order-buyer__field"),e=!1)),i="#err-buyer",o=o.join(", ")),e&&(o=[],!t("#valid-one").prop("checked")&&(o.push(".valid-order:first-child"),e=!1),!t("#valid-two").prop("checked")&&(o.push(".valid-order:last-child"),e=!1),i="#err-side",o=o.join(", ")),e?void BX.Sale.OrderAjaxComponent.sendRequest("saveOrderAjax"):(t(o).addClass("error"),t("html, body").animate({scrollTop:t(i).offset().top-180+"px"},{duration:1e3,easing:"swing"}),!1)})}function g(t,e,i,o){var n=Math.round;t=(t+"").replace(/[^0-9+\-Ee.]/g,"");var s=isFinite(+t)?+t:0,a=isFinite(+e)?v(e):0,r=void 0===o?",":o,l=void 0===i?".":i,c="";return c=(a?function(t,e){var i=Math.pow(10,e);return""+(n(t*i)/i).toFixed(e)}(s,a):""+n(s)).split("."),3<c[0].length&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(c[1]||"").length<a&&(c[1]=c[1]||"",c[1]+=Array(a-c[1].length+1).join("0")),c.join(l)}var v=Math.abs;window.order_step={city:!1,deliver:!1,payment:!1},t(function(){e(),i(),o(),n(),s(),r(),l(),c(),d(),p(),u(),h(),f()}),t(window).scroll(function(){var e=t(window).scrollTop();10<e?t(".header__bottom").css({"background-color":"#f2f5f9"}):0==e&&t(".header__bottom").css({"background-color":"transparent"})}),t(".slider-sales").slick({slidesToShow:3,slidesToScroll:3,infinite:!0,arrows:!0,prevArrow:'<div class="custom-slick-arrow custom-slick-arrow--prev"><span></span></div>',nextArrow:'<div class="custom-slick-arrow custom-slick-arrow--next"><span></span></div>',responsive:[{breakpoint:769,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:481,settings:{slidesToShow:1,slidesToScroll:1,arrows:!1,dots:!0}}]})}(jQuery);